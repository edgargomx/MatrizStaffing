<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script type="module">
        import '../hours-table.js';
        import '@polymer/paper-toast/paper-toast.js';
    </script>
    <title>HoursTable</title>
    <style>
        @font-face {
            font-family: 'Grotesk';
            src: url('./assets/tipografias/SF UI Display Secundaria/SFDisplay-Regular.otf'),
                 url('./assets/tipografias/Typo Grotesk Primaria/Typo Grotesk Bold Demo.otf'),
                 url('./assets/tipografias/Typo Grotesk Primaria/Typo Grotesk Italic Demo.otf'),
                 url('./assets/tipografias/Typo Grotesk Primaria/Typo Grotesk Bold Italic Demo.otf');
        }
    </style>
</head>
<body>
    <style>
    </style>
        <div>
            <h2>Insertar año</h2>
            <hours-table id="demo-insert" url="./assets/Acciones.png"></hours-table>
            <input id="first-year" type="text">
            <button id="insert-year" >Insertar año</button>
        </div>

        <div>
            <h2>Seleccionar año y abrir formulario</h2>
            <hours-table id="demo-years" url="./assets/Acciones.png"></hours-table>
            <paper-toast id="toast-years"></paper-toast>
        </div>

        <div>
            <h2>Nuevo año y evento</h2>
            <hours-table id="demo-two" url="./assets/Acciones.png"></hours-table>
            <input id="second-year" type="text">
            <button id="second-year-button">Insertar año</button>
            <paper-toast id="toast-two"></paper-toast>
        </div>

        <script>
            const demoInsert = document.querySelector('#demo-insert');
            const paperToastYears = document.querySelector('#toast-years');
            const paperToastTwo = document.querySelector('#toast-two')
            const demoYearSelected = document.querySelector('#demo-years');
            const demoOfTwo = document.querySelector('#demo-two');
            const firstNewYear = document.querySelector('#first-year');
            const secondNewYear = document.querySelector('#second-year');
            
            const rawData = {
            '2020' : {
                january:'220',
                february:'220',
                march:'220',
                april:'220',
                    may:'220',
                    june:'220',
                    july:'220',
                    august:'220',
                    september:'220',
                    october:'220',
                    november:'220',
                    december:'220'
                },'2019' : {
                    january:'219',
                    february:'219',
                    march:'219',
                    april:'219',
                    may:'219',
                    june:'219',
                    july:'219',
                    august:'219',
                    september:'219',
                    october:'219',
                    november:'219',
                    december:'219'
                },'2018' : {
                    january:'218',
                    february:'218',
                    march:'218',
                    april:'218',
                    may:'218',
                    june:'218',
                    july:'218',
                    august:'218',
                    september:'218',
                    october:'218',
                    november:'218',
                    december:'218'
                }, '2021' : {
                    january:'221',
                    february:'221',
                    march:'221',
                    april:'221',
                    may:'221',
                    june:'221',
                    july:'221',
                    august:'221',
                    september:'221',
                    october:'221',
                    november:'221',
                    december:'221'
                }
            }
            for(const demos of [demoInsert, demoYearSelected, demoOfTwo]){
                customElements.whenDefined(demos.localName).then(() => {
                    demos.setRawData(rawData)
                    demos.addEventListener('edited', event => {
                        rawData[event.detail.year] = {
                            january: event.detail.january,
                            february :event.detail.february,
                            march    :event.detail.march,
                            april    :event.detail.april,
                            may      :event.detail.may,
                            june     :event.detail.june,
                            july     :event.detail.july,
                            august   :event.detail.august,
                            september :event.detail.september,
                            october  :event.detail.october,
                            november :event.detail.november,
                            december :event.detail.december
                        }
                        demos.setRawData(rawData)
                    })
                    demos.addEventListener('created', event => {
                        rawData[event.detail.year] = {
                            january: event.detail.january,
                            february :event.detail.february,
                            march    :event.detail.march,
                            april    :event.detail.april,
                            may      :event.detail.may,
                            june     :event.detail.june,
                            july     :event.detail.july,
                            august   :event.detail.august,
                            september :event.detail.september,
                            october  :event.detail.october,
                            november :event.detail.november,
                            december :event.detail.december
                        }
                        demos.setRawData(rawData)
                    })
                })
            }
            
            demoYearSelected.addEventListener('year-selected', event => {
                paperToastYears.text = event.detail.year;
                paperToastYears.open()
            })

            demoYearSelected.addEventListener('open-form', event => {
                paperToastYears.text = 'Abrir formulario';
                paperToastYears.open()
            })

            demoOfTwo.addEventListener('year-selected', event => {
                paperToastTwo.text = event.detail.year;
                paperToastTwo.open()
            } )
            const insertYear = document.querySelector('#insert-year')
            insertYear.addEventListener('click', () => {
                demoInsert.years = [...demoInsert.years, {year: firstNewYear.value}]
            })

            const insertSecondYear = document.querySelector('#second-year-button')
            insertSecondYear.addEventListener('click', () => {
                demoOfTwo.addNewYear(secondNewYear.value)
            })
            
            
        </script>
</body>
</html>
